#!/bin/bash

exec > ~/.logs/$(basename $0).log 2>&1
set -x

TEMP=$(getopt -o p: --long phone: -n $(basename $0) -- "$@")
phone=
eval set -- "$TEMP"
while true; do
    case "$1" in
        -p|--phone)
            phone=$2
            shift 2
            ;;
        --)
            shift
            break
            ;;
        *)
            die "internal error"
            ;;
    esac
done

if test "$phone"; then
    build=$(cd-adb | xargs basename)
else
    build=$(cd ~/smb/share.smartisan.cn/SanFranciscoBuild/sanfrancisco_android/release-$(today--); command ls -t -1|sort -n |tail -n 1)
fi

putclip '*模块'; sawfish-browser-input C-s C-v C-g
sleep 1
sawfish-browser-input TAB Home Down Down Down Down
sawfish-browser-input TAB Home $(for x in $(seq 1 22); do echo Down; done) Tab Tab Tab Down
sawfish-browser-input TAB TAB TAB TAB

putclip "$build"; sawfish-browser-input C-v Tab
sleep .5

putclip 'P4'; sawfish-browser-input C-v Tab End
sleep .5
putclip '分派给'; sawfish-browser-input C-s C-v C-g
sleep .5
sawfish-browser-input Tab B Tab
