#!/bin/bash
if test "$(gettask-android)" = com.android.browser; then
    adb-swipe 200 300 200 1000
    adb-tap 713 147
    adb-wide-tap-2 1031 274
    adb-wide-tap 767 291
elif test "$(gettask-android)" = com.tencent.mobileqq; then
    adb-tap 990 114
    adb-tap 367 1486
    firefox -new-tab "$(getclip-android)"
    exit
elif test "$(gettask-android)" = com.sina.weibo; then
    adb-tap 990 114
    adb-tap 318 1562
    firefox -new-tab "$(getclip-android)"
    exit
else # firefox?
    adb-tap $((0 + 249)) $((1080 - 950))
    adb-tap $((0 + 238)) $((1080 - 842))
    adb-tap $((0 + 277)) $((1080 - 693))
fi

sleep .5
popup_win=$(adb dumpsys window | grep '^  Window.*#.*popupw' -P -i -A 8 | perl -ne 'm/mShownFrame=\[(\d+).0,(\d+).0\]/ and print "$1 $2\n"'| head -n 1)
xy=($popup_win)
x=${xy[0]}
y=${xy[1]}

# 624 400
adb-tap $((x + 624 - 355)) $((y + 400 - 302))
firefox -new-tab "$(getclip-android)"
