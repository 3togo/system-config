#!/bin/bash


TEMP=$(getopt -o u:d: --long utc:dir -n $(basename $0) -- "$@")
utc=
dir=sanfrancisco_android
eval set -- "$TEMP"
while true; do
    case "$1" in
        -u|--utc)
            utc=$2
            shift 2
            ;;
        -d|--dir)
            dir=$2
            shift 2
            ;;
        --)
            shift
            break
            ;;
        *)
            die "internal error"
            ;;
    esac
done

if test ! "$utc"; then
    utc=$(adb getprop ro.build.date.utc)
fi
time=$(epoch2date $utc)
date=$(echo $time | perl -npe 's/T.*//; s/-//g')
tag=$(echo $time | perl -npe 's/-//g; s/T/-/; s/://g')

cd ~/smb/share.smartisan.cn/SanFranciscoBuild/$dir/release-$date

if test "$(echo *$tag*)" != "*$tag*"; then
    for x in *$tag*; do
        builtin cd $x;
        break
    done
fi
pwd
if is-tty-io; then
    pwd|putclip
fi
