#!/bin/bash

adb-tty getevent -l </dev/tty | perl -ne '
    if (m/ABS_MT_POSITION_/) {
        chomp;
        @fields = split;
        ($name, $val) = @fields[2,3];
        $val = hex($val);
        print "$name: $val\r\n";
        if ($name =~ m/ABS_MT_POSITION_X/) {
            $x = $val;
        } elsif ($name =~ m/ABS_MT_POSITION_Y/) {
            $y = $val;
        }
        system("putclip adb-tap $x $y");
    }
'
