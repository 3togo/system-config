#!/usr/bin/perl
use strict;
use Encode;
open(my $unicodeData, "<", glob("~/.emacs_d/UnicodeData.txt")) or die "Can't open unicode file";

@ARGV = sort {length($b) <=> length($a)} @ARGV;

my @lines;
my @argv_re;
for (@ARGV) {
    push @argv_re, qr(\Q$_\E)i;
}
while (<$unicodeData>) {
    if (m/$argv_re[0]/) {
        push @lines, $_;
    }
    if (@lines > 1000) {
        last;
    }
}
shift @argv_re;
for my $line (@lines) {
    my $match = 1;
    for (@argv_re) {
        unless ($line =~ m/$_/) {
            $match = 0;
            last;
        }
    }
    if ($match) {
        my ($code, $name) = split(';', $line);
        print encode_utf8(chr(hex($code))), "   $name\n";
    }
}
